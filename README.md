# project-212-Alhassliebe

#### Работа выполнена студенткой Муравьевой Алёной ####

### Про бот ###
Результатом проекта стал **бот-рифмоплет**, который пишет стихи на английском языке по заданной тематике, метру, длине строки и, конечно, слову-ориентиру. ***@Eng_Rifmoplet_bot***. Бот размещен на pythonanywhere.com  
Взаимодействие пользователя с ботом выглядит так:

https://user-images.githubusercontent.com/90255314/227801810-6c228525-52a0-456f-a45d-0359c60198ca.MP4

Как мы видим, сначала пользователю предлагается выбрать тематику стихотворения из трех предложенных (в дальнейшем именно из этой книги
или из субтитров этого фильма будут браться строки для стихотворения).  
Далее пользователю нужно выбрать метр стиха. Для простоты бот отправляет фото с пояснением того, что означает каждый метр.  
После этого пользователь отправляет слово, с которым будет строиться стих, букву (A или В) -- то есть последним словом какой строки будет введенное слово -- 
и размер строки от минимального до максимального (счет идет по слогам).  
И на этом все! Бот выводит готовый стих. По желанию, нажав кнопку "YES!", можно на этих же данных построить уже другое стихотворение.  
  
Бот также оборудован командами   
/start - запуск бота с самого начала  
/cancel - остановка бота после его запуска  
/help - краткий справочник с командами

Бот написан при помощи библиотеки **python-telegram-bot**. На основе модуля расширений telegram.ext был построен асинхронный бот.
Код, непосредственно связанный с ботом, лежит в файле **Botik.py**

### Про предобработку файлов ###

Файл **text_to_data.py** запускается предварительно независимо от бота. Он нужен для того, чтобы текстовые файлы с книгами и субтитрами были преобразованы в базы данных. 
Текст делится на предложения (raw_text), в этих предложениях считаются слоги (syllable_count) и определяется рифма = последняя гласная + последующие согласные (rhyme).
Это происходит благодаря самому-самому важному файлу **poem_creator.py**, в котором происходит вся грязная работа этого проекта.  

![db](https://user-images.githubusercontent.com/90255314/227803446-566ec944-9c4b-458d-a26c-af49e2389061.PNG)

### Про самый-самый важный файл ###

Как вы уже поняли, это **poem_creator.py**  

В class Line происходит обработка строк. Берется транскрипция каждого слова из CMUdict (Словарь произношения Карнеги-Меллона) -- nltk.download('cmudict') --
этот словарь для каждого слова возвращает список возможных произношений, отдельное произношение является массивом фонем. Фонетическая позиция гласного обозначена цифрой от 0 до 2 -
именно по ним мы определяем гласный это звук или согласный. Число гласных в строке (=число слогов) задает syllable_count. Рифмой для строки является кластер "последняя гласная + последующие согласные"
крайнего слова в строке.  

![cmudict](https://user-images.githubusercontent.com/90255314/227804831-87d32312-2a9b-4531-934c-0cbe9dea15f6.PNG)  

В class DataBase происходит обработка баз данных. Как раз об этом мы говорили в пункте про предобработку файлов.  

Остальные функции в файле направлены уже на работу бота. В самом файле есть комментарии по каждой функции.
